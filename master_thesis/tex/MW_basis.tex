\makeatletter
\def\input@path{{../}}
\makeatother
\documentclass[../master_thesis.tex]{subfiles}
\begin{document}
\chapter{\ac{MW} Basis}
As stated on the previous chapter, the main goal of computational chemistry is
to approximate systems in order to calculate their energy through the \ac{SE}. %cite please
These systems are completelly described by wave functions \cite{Cohen:1973}.
This means that to approximate a solution to the system is to approximate its
wave function.

In order to construct a solution (wave function) to the \ac{SE} of a given
system one uses sets of orthogonal functions with differing properties. These
sets of functions construct a basis for the space on which the wave functions
are projected into. These sets are thus called basis sets \cite{Cramer:2004}
and they are essential to solving many body systems. In this text we will be
focusing in the \ac{MW} basis from \ac{MRA} methods.

\section{\ac{MRA}}
\subsection{Definition}
Consider that we have a function $\varphi \in L^2(\mathbb{R})$ where its tanslations
and dilations are described as \cite{Schneider:2007}
\begin{equation}
  \varphi^j_k(x) = 2^{\frac{j}{2}}\varphi(2^jx - k),\  j,k \in \mathbb{Z}
\end{equation}.
Where $j$ is the scale of the function and $k$ is the translation of the function
\cite{Sorland}
A space $V_n$ is spanned by translations of $\varphi_{nk}$.This space forms a
hierarchical chain of Linear
subspaces \cite{Beylkin:MRA}:
\begin{equation}
  V_0 \subset V_1 \subset ... \subset V_n \subset ... \subset \mathbb{L}^2(\mathbb{R})\label{eq:seqsubspace}
\end{equation}
Where $V_0$ is spanned only by $\varphi_{0,0}(x)=\varphi(x)$ \cite{Sorland}.
The function $\varphi(x)$ satisfies the two-scale difference relations \cite{Beylkin:MRA, Schneider:2007, Sorland}:
\begin{align}
  \begin{split}
    \varphi(x) &= \varphi(2x) + \varphi(2x - 1)\\
    \varphi^j_k(x) &= \varphi^{j+1}_{2k}(2^{j+1}x - 2k) + \varphi^{j+1}_{2k+1}(2^{j+1}x - 2k - 1)
  \end{split}
\end{align}

If relation \ref{eq:seqsubspace} and the following refinement equation holds for $\varphi_{j,k}(x)$
one can call the subspaces $V_n$ or the functions $\varphi_{j,k}(x)$ build a \ac{MRA} of $L_2(\mathbb{R})$.
\begin{equation}
\varphi^j_k(x) = \sum_{k\in\mathbb{Z}} h^{j+1}_k\varphi^{j+1}_k(x)
\end{equation}
Where $h$ is a coefficient characteristic to the transformation between scales.
\subsection{Wavelet \ac{MRA}}
Following from now we will work with the Haar wavelet basis for simplicity \cite{Beylkin:MRA}.
Lets define the Haar function \cite{Schneider:2007} as
\begin{equation}
  \varphi^0_0 = \varphi(x) =
  \begin{cases}
  1 & \text{for} \ x\in [0,1)\\
  0 & \text{elsewhere}
\end{cases}
\end{equation}
Lets now define a second set of subspaces $W_n$. These are the difference subspaces
defined as \cite{Beylkin:MRA, Sorland}
\begin{equation}
  W_n \oplus V_n = V_{n + 1} \label{eq:diffsubspace}
\end{equation}
The subspaces $W_n$ are then spanned by a set of functions defined by the translations and
dilations of $\psi(x)$:
\begin{equation}
  \psi_{j,k}(x) = 2^{\frac{j}{2}}\psi(2^jx - k),\  j,k \in \mathbb{Z} \label{eq:haarwavelet}
\end{equation}
Where $\psi(x)$ is called the Haar wavelet \cite{Schneider:2007} and is defined as:
\begin{equation}
  \psi^0_0 = \psi(x) =
  \begin{cases}
  1 & \text{for} \ x\in [0,\frac{1}{2})\\
  -1 & \text{for}\ x\in [\frac{1}{2}, 1)\\
  0 & \text{elsewhere}
\end{cases}
\end{equation}
And $ \varphi$ is related to $\psi$ by the following two-scale difference relation \cite{Beylkin:MRA, Schneider:2007, Sorland}:
\begin{align}
  \begin{split}\label{eq:2scalewavelet}
    \psi(x) &= \varphi(2x) - \varphi(2x - 1)\\
    \psi^j_k(x) &= \psi^{j+1}_{2k}(2^{j+1}x - 2k) + \psi^{j+1}_{2k+1}(2^{j+1}x - 2k - 1)
  \end{split}
\end{align}
The functions $\varphi^j_k$ and $\psi^j_k$ are orthonormal
and dense \cite{Beylkin:MRA, Sorland, SRJensen:2014} in $\mathbb{L}^2(\mathbb{R})$.

The Definition on Equation \ref{eq:diffsubspace} can be applied recursivelly in order to
get any space $V_n$ as long as one knows the first subspace $V_0$ and one has a method for constructing the
subspace $W_m$ from $V_0$ and $W_{m-1}$.
\begin{equation}
    V_0 \oplus W_0 \oplus W_1 \oplus ... \oplus W_{n-1}  = V_n \label{eq:recursivespace}
\end{equation}

Projecting a function $f(x)$ unto this basis would be then a weighted linear combination
of the Haar functions, but taking into account the definition on Equation \ref{eq:recursivespace} one arrives
at \cite{Sorland}.
\begin{equation}\label{eq:projectftohaar}
  f(x)\approx \sum^{2^j -1}_k \sum^{N}_j s^j_k\varphi^j_k = s^0_0\varphi^0_0 + \sum^{2^j -1}_k \sum^{N - 1}_jd^j_k\psi^j_k
\end{equation}
where $d$ are the difference coefficients and $s$ are the scaled averages of dyadilic intervals of the function $f(x)$

The scaling coefficients $s^j_k$ are computed by the projection $\braket{\varphi^j_k(x)|f(x)}$.
Likewise the difference coefficients $d^j_k(x)$ are computed by the projection \newline$\braket{\psi^j_k(x)|f(x)}$.
Because of the way the Haar function is defined, we can define of the scaling coefficients as
scaled averages of $f(x)$ at intervals $2^{-j}$ \cite{Sorland, Beylkin:MRA}
\begin{equation}
  s^j_k = \int_{\mathbb{R}}\varphi^j_k(x)f(x)\text{d}x = \int^{2^{-j}(k + 1)}_{2^{-j}k} f(x) \text{d}x\label{eq:scalecoeff1}
\end{equation}
We can then obtain the difference coefficients by using Equations \ref{eq:scalecoeff1}, \ref{eq:haarwavelet} and \ref{eq:2scalewavelet}:
\begin{align}
  \begin{split}\label{eq:diffcoeffint}
    d^{j - 1}_k &= \int_{\mathbb{R}}\psi^{j-1}_k(x)\text{d}x\\
    d^{j - 1}_k &= 2^{\frac{j - 1}{2}}\int_{\mathbb{R}}\psi(2^{j-1}x - k)f(x)\text{d}x\\
    d^{j - 1}_k &= 2^{\frac{j - 1}{2}}\left(\int_{\mathbb{R}}\varphi(2^jx - 2k)f(x)\text{d}x  - \int_{\mathbb{R}}\varphi(2^jx - 2k - 1)f(x)\text{d}x\right)\\
    d^{j - 1}_k &= 2^{\frac{j - 1}{2}}\left( \int^{2^{-j}(2k+1)}_{2^{-j}2k}f(x)\text{d}x - \int^{2^{-j}(2k+2)}_{2^{-j}(2k + 1)}f(x)\text{d}x \right)\\
    d^{j - 1}_k &= \frac{1}{\sqrt{2}}\left(s^{j}_{2k} - s^{j}_{2k+1} \right)
  \end{split}
\end{align}
The scaling coefficients can be obtained in the same manner:
\begin{align}
  \begin{split}\label{eq:scalecoeffint}
    s^{j - 1}_k &= \int_{\mathbb{R}}\varphi^{j-1}_k(x)\text{d}x\\
    s^{j - 1}_k &= 2^{\frac{j - 1}{2}}\int_{\mathbb{R}}\varphi(2^{j-1}x - k)f(x)\text{d}x\\
    s^{j - 1}_k &= 2^{\frac{j - 1}{2}}\left(\int_{\mathbb{R}}\varphi(2^jx - 2k)f(x)\text{d}x  + \int_{\mathbb{R}}\varphi(2^jx - 2k - 1)f(x)\text{d}x\right)\\
    s^{j - 1}_k &= 2^{\frac{j - 1}{2}}\left( \int^{2^{-j}(2k+1)}_{2^{-j}2k}f(x)\text{d}x + \int^{2^{-j}(2k+2)}_{2^{-j}(2k + 1)}f(x)\text{d}x \right)\\
    s^{j - 1}_k &= \frac{1}{\sqrt{2}}\left(s^{j}_{2k} + s^{j}_{2k+1} \right)
  \end{split}
\end{align}

The result of Equations \ref{eq:diffcoeffint} and \ref{eq:scalecoeffint} show us
that we can represent the projection of coefficients unto a coarser scale as an
orthogonal matrix \cite{Sorland, Beylkin:MRA}:
\begin{equation}
  \begin{pmatrix}
    d^{j}_k \\
    s^{j}_k
  \end{pmatrix} =
  \begin{pmatrix}
    \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} \\
    \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}
  \end{pmatrix}
  \begin{pmatrix}
    s^{j+1}_{2k} \\
    s^{j+1}_{2k+1}
  \end{pmatrix}
\end{equation}
Projecting the coefficients into a more refined scale is just a transpose of the
above matrix:
\begin{equation}
  \begin{pmatrix}
    s^{j+1}_{2k} \\
    s^{j+1}_{2k+1}
  \end{pmatrix} =
  \begin{pmatrix}
    \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\
    -\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}
  \end{pmatrix}
  \begin{pmatrix}
    d^{j}_k \\
    s^{j}_k
  \end{pmatrix}
\end{equation}

As an example, lets approximate the function
$f(x) = \frac{10}{\sqrt{\pi}}e^{-100(x - 0.5)^2}$ in $\mathbb{L}^2(\mathbb{R})$
with Haar basis up to scale $5$ using \ref{eq:projectftohaar}. Gives us the
following figures.
%put the plots here

\section{The \ac{MW} Basis}

\subsection{Constructing The Basis}
\subsubsection{Polynomials}
\subsubsection{Scale}
\subsubsection{World size}
\subsubsection{Precision threshold}
\subsection{Operators}
\subsection{Functions}
\section{Solving systems}
\subsection{Integral equations}
\subsection{Differential equations}
\section{Software}
\input{acronyms.tex}
\biblio
\end{document}
